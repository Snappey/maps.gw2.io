<div style="height: 100vh; background: #000;"
     leaflet
     [leafletOptions]="options"
     (leafletMapReady)="onMapReady($event)"
     tabindex="0">
</div>

<div [hidden]="showMatches" style="position: absolute; z-index: 999; left: 10px; top: 15px">
  <ng-container *ngIf="activeMatch$ | async as activeMatch">
    <ng-container *ngIf="activeMatch">
      <app-score-overview [loading]="false" [small]="smallScreen" [match]="activeMatch"></app-score-overview>
    </ng-container>
  </ng-container>
</div>

<div class="flex flex-row align-items-center justify-content-center" style="position: absolute;  z-index: 999; width: 100%; bottom: 5px;">
  <button pButton tabindex="-1" class="p-button-raised p-button-rounded mx-1 clickable" (click)="showScore = !showScore" icon="pi pi-chart-bar"></button>
  <button pButton tabindex="-1" class="p-button-raised p-button-rounded mx-1 clickable" (click)="showMatches = !showMatches" icon="pi pi-list"></button>
  <button pButton tabindex="-1" class="p-button-raised p-button-rounded mx-1 clickable" (click)="showSettings = !showSettings" icon="pi pi-cog"></button>
</div>


<p-dialog header="Settings" [(visible)]="showSettings">
  <label class="font-bold">Home World:</label>
  <p-dropdown *ngIf="worlds$ | async as worlds"
              appendTo="body"
              [style]="{width: '100%'}"
              [options]="worlds | orderBy:'id'" optionLabel="name" [(ngModel)]="selectedWorld"
              [filter]="true" filterBy="name">
  </p-dropdown>
  <ng-template pTemplate="footer">
    <p-button icon="pi pi-check" (click)="saveSettings(selectedWorld); this.showSettings = false" label="Save" styleClass="p-button p-button-text p-button-success"></p-button>
    <p-button icon="pi pi-times" (click)="this.showSettings = false" label="Cancel" styleClass="p-button p-button-text p-button-danger"></p-button>
  </ng-template>
</p-dialog>


<div *ngIf="showScore" style="position: absolute; z-index: 999; left: 15%; top: 25%; width: 75vw; height: 50vh;">
  <ng-container *ngIf="activeMatch$ | async as activeMatch">
    <div class="tooltip p-3" *ngIf="activeMatch">
      <app-skirmish-stats-chart [match]="activeMatch" height="50vh"></app-skirmish-stats-chart>
    </div>
  </ng-container>
</div>

<!--
<p-sidebar [(visible)]="showScore" [showCloseIcon]="false" position="bottom" styleClass="p-sidebar-lg">
  <div class="grid my-0" *ngIf="selectedMatch">
    <div class="lg:col-4 col-12">
      <h1 class="my-2 text-center">Fight Stats</h1>
      <app-fight-stats-chart height="24rem" [match]="selectedMatch"></app-fight-stats-chart>
    </div>
    <div class="lg:col-8 col-12">
      <h1 class="my-2 text-center">Skirmish Stats</h1>
      <app-skirmish-stats-chart height="24rem" [match]="selectedMatch"></app-skirmish-stats-chart>
    </div>
  </div>
</p-sidebar>
-->

<div [hidden]="!showMatches" class="overflow-auto h-auto w-auto my-5" style="position: absolute; z-index: 999; left: 0; right: 0; top: 25px; margin-left: auto; margin-right: auto">
    <app-match-overview (clickedMatch)="overviewMatchClicked($event)"></app-match-overview>
</div>


<p-dialog header="Objective Upgrades" [(visible)]="showObjectiveDetails" [style]="{width: '50vw'}"
          [draggable]="true" [resizable]="false">
  <app-objective-details *ngIf="selectedObjective" [objective]="selectedObjective"></app-objective-details>
</p-dialog>
